<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Long‑Term Strategy – Monthly Projection</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Simple fade‑in animation for summary cards */
    .fade-enter { opacity: 0; transform: translateY(12px); }
    .fade-enter-active { transition: all 0.45s ease; opacity: 1; transform: translateY(0); }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-3xl md:text-4xl font-extrabold mb-6 text-center">Long‑Term Strategy – Monthly Projection</h1>

  <!-- INPUT PANEL -->
  <form id="inputs" class="w-full max-w-5xl bg-white p-6 rounded-2xl shadow-lg grid gap-4 md:grid-cols-3">
    <div class="flex flex-col">
      <label for="initial" class="font-medium mb-1">Initial Fund (₹)</label>
      <input id="initial" type="number" value="10000000" class="border rounded-lg p-2" />
    </div>
    <div class="flex flex-col">
      <label for="liquidRate" class="font-medium mb-1">Liquid Fund Return (annual %)</label>
      <input id="liquidRate" type="number" step="0.01" value="6.24" class="border rounded-lg p-2" />
    </div>
    <div class="flex flex-col">
      <label for="pledgePct" class="font-medium mb-1">Pledge % of Fund</label>
      <input id="pledgePct" type="number" step="0.01" value="90" class="border rounded-lg p-2" />
    </div>
    <div class="flex flex-col">
      <label for="optionRate" class="font-medium mb-1">Option Selling Return (annual %)</label>
      <input id="optionRate" type="number" step="0.01" value="8" class="border rounded-lg p-2" />
    </div>
    <div class="flex flex-col">
      <label for="equityRate" class="font-medium mb-1">Equity/SIP Return (annual %)</label>
      <input id="equityRate" type="number" step="0.01" value="12" class="border rounded-lg p-2" />
    </div>
    <div class="flex flex-col">
      <label for="years" class="font-medium mb-1">Tenure (Years)</label>
      <input id="years" type="number" value="15" class="border rounded-lg p-2" />
    </div>
    <div class="md:col-span-3 flex justify-center mt-2">
      <!-- Prevent form submit refresh by using type="button" -->
      <button id="calc" type="button" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-xl transition-all duration-200">Calculate</button>
    </div>
  </form>

  <!-- SUMMARY -->
  <div id="summary" class="w-full max-w-5xl mt-6 hidden"></div>

  <!-- RESULTS TABLE -->
  <div class="w-full max-w-6xl mt-8 overflow-x-auto">
    <table class="min-w-full bg-white rounded-2xl overflow-hidden shadow-md">
      <thead class="bg-gray-200">
        <tr class="text-center">
          <th class="px-4 py-2">#</th>
          <th class="px-4 py-2">Year</th>
          <th class="px-4 py-2">Month</th>
          <th class="px-4 py-2">Liquid&nbsp;Income (₹)</th>
          <th class="px-4 py-2">Option&nbsp;Income (₹)</th>
          <th class="px-4 py-2">Equity End (₹)</th>
          <th class="px-4 py-2" title="Initial Fund + Equity Value">Total Portfolio (₹)</th>
        </tr>
      </thead>
      <tbody id="results"></tbody>
    </table>
  </div>

  <!-- PAGINATION -->
  <div id="pagination" class="flex items-center space-x-4 mt-4"></div>

  <script>
    const PAGE_SIZE = 12;
    let monthlyData = [];
    let currentPage = 1;
    let principal = 0;

    const INR = n => n.toLocaleString('en-IN', {style:'currency',currency:'INR',maximumFractionDigits:0});

    function calcProjection(){
      principal = +document.getElementById('initial').value || 0;
      const liquid = (+document.getElementById('liquidRate').value||0)/100;
      const pledge = (+document.getElementById('pledgePct').value||0)/100;
      const option = (+document.getElementById('optionRate').value||0)/100;
      const equityR= (+document.getElementById('equityRate').value||0)/100;
      const years  = +document.getElementById('years').value||0;
      const months = years*12;

      monthlyData=[]; let equity=0;
      for(let m=1;m<=months;m++){
        const liq = principal*(liquid/12);
        const opt = principal*pledge*(option/12);
        equity = equity*(1+equityR/12)+liq+opt;
        monthlyData.push({
          index:m,
          year:Math.ceil(m/12),
          month:((m-1)%12)+1,
          liq,opt,equity:Math.round(equity),
          total:Math.round(principal+equity)
        });
      }
    }

    function drawTable(){
      const tbody=document.getElementById('results');
      tbody.innerHTML='';
      const start=(currentPage-1)*PAGE_SIZE;
      monthlyData.slice(start,start+PAGE_SIZE).forEach(r=>{
        tbody.insertAdjacentHTML('beforeend',`
          <tr class="text-center hover:bg-gray-50">
            <td class="border px-4 py-2">${r.index}</td>
            <td class="border px-4 py-2">${r.year}</td>
            <td class="border px-4 py-2">${r.month}</td>
            <td class="border px-4 py-2">${INR(r.liq)}</td>
            <td class="border px-4 py-2">${INR(r.opt)}</td>
            <td class="border px-4 py-2">${INR(r.equity)}</td>
            <td class="border px-4 py-2 font-semibold" title="Initial: ${INR(principal)} + Equity: ${INR(r.equity)}">${INR(r.total)}</td>
          </tr>`);
      });
      drawPagination();
    }

    function drawPagination(){
      const pages=Math.ceil(monthlyData.length/PAGE_SIZE)||1;
      const container=document.getElementById('pagination');
      container.innerHTML='';
      if(pages<=1) return;
      container.insertAdjacentHTML('beforeend',`
        <button id="prev" class="px-3 py-1 bg-gray-200 rounded-lg" ${currentPage===1?'disabled':''}>Prev</button>
        <span class="font-medium">Page ${currentPage}/${pages}</span>
        <button id="next" class="px-3 py-1 bg-gray-200 rounded-lg" ${currentPage===pages?'disabled':''}>Next</button>`);
      document.getElementById('prev').onclick=()=>{if(currentPage>1){currentPage--;drawTable();}};
      document.getElementById('next').onclick=()=>{if(currentPage<pages){currentPage++;drawTable();}};
    }

    function animate(el,end){
      const start=0;const dur=1000;const st=performance.now();
      function step(now){
        const p=Math.min((now-st)/dur,1);el.textContent=INR(Math.floor(start+(end-start)*p));if(p<1)requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    function showSummary(){
      const sum=document.getElementById('summary');
      if(!monthlyData.length){sum.classList.add('hidden');return;}
      const last=monthlyData[monthlyData.length-1];
      sum.innerHTML=`
        <div class="bg-white rounded-2xl shadow p-6 grid md:grid-cols-4 gap-6 text-center fade-enter">
          <div><h2 class="text-xl font-semibold mb-1">Initial Fund</h2><p id="sInit" class="text-lg font-medium"></p></div>
          <div><h2 class="text-xl font-semibold mb-1">Equity Value (End)</h2><p id="sEquity" class="text-lg font-medium"></p></div>
          <div><h2 class="text-xl font-semibold mb-1">Total Portfolio (End)</h2><p id="sTotal" class="text-lg font-medium"></p></div>
          <div><h2 class="text-xl font-semibold mb-1">Total Months</h2><p id="sMonths" class="text-lg font-medium">${monthlyData.length}</p></div>
        </div>`;
      sum.classList.remove('hidden');
      requestAnimationFrame(()=>sum.firstElementChild.classList.add('fade-enter-active'));
      animate(document.getElementById('sInit'),principal);
      animate(document.getElementById('sEquity'),last.equity);
      animate(document.getElementById('sTotal'),last.total);
    }

    function calculateAndRender(){
      calcProjection();
      currentPage=1;
      drawTable();
      showSummary();
    }

    document.getElementById('calc').addEventListener('click',calculateAndRender);
    // initial draw
    calculateAndRender();
  </script>
</body>
</html>

